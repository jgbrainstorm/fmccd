#! /usr/bin/env python
import sys
sys.path.append('/home/jghao/fmccd')
from fermiMCCD import *
ext=np.array([2,3,5,41,42,38,39,8,19,20,21])

catdir='/data/10Jan2011_0deg/hexpodmove/catalog/'


CatFits=gl.glob(catdir+'*_exten_'+str(ext[i])+'_*.fits')
CatFits.sort()
Nfits=len(CatFits)
for i in range(Nfits):

x0=pf.getdata(CatFits[0]).field('x_image')
y0=pf.getdata(CatFits[0]).field('y_image')
flux=pf.getdata(CatFits[0]).field('flux_best')
ok=flux>np.mean(flux)
x0=x0[ok]
y0=y0[ok]


Mxdiff=[]
Mydiff=[]
SDxdiff=[]
SDydiff=[]
for j in range(1,len(CatFits)):
    x1=pf.getdata(CatFits[j]).field('x_image')
    y1=pf.getdata(CatFits[j]).field('y_image')
    i0,i1=xy_matching(xa=x0,ya=y0,xb=x1,yb=y1,sep=20)
    Mydiff.append(np.mean(y1[i1]-y0[i0]))
    Mxdiff.append(np.mean(x1[i1]-x0[i0]))
    SDydiff.append(np.std(y1[i1]-y0[i0]))
    SDxdiff.append(np.std(x1[i1]-x0[i0]))

Mydiff=np.array(Mydiff)
Mxdiff=np.array(Mxdiff)
SDydiff=np.array(SDydiff)
SDxdiff=np.array(SDxdiff)

xshift=np.arange(10,200,10)
